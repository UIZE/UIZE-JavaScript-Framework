/*
	UIZE JAVASCRIPT FRAMEWORK

	http://www.uize.com/reference/Uize.Build.AutoScruncher.html
	Available under MIT License or GNU General Public License -- http://www.uize.com/license.html
*/
Uize.module({name:'Uize.Build.AutoScruncher',required:['Uize.Wsh','Uize.Build.Scruncher','Uize.Date','Uize.String','Uize.String.Lines','Uize.Util.Oop'],builder:function(){var _a=function(){};_a.getScrunchedFolderPath=function(_b,_c,_d){var _e=Uize.Wsh.getScriptFolderPath(),_f=_d?_d.length:0;return(_f?(_b.slice(-_f)==_d?_b.slice(0,-_f-1):null):(_c&&_e+'\\'+_c)+_b.substr(_e.length));};_a.perform=function(_g){var _h=Uize.Date.toIso8601(),_i=/\.js$/,_j=WScript.ScriptName,_k=_g.scrunchedHeadComments||{},_l='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ',_m,_n=Uize.Wsh.getScriptFolderPath()+'\\'+_g.moduleFolderPath;function _o(_b){return _a.getScrunchedFolderPath(_m=_b,_g.buildFolderPath,_g.sourceFolderName);}Uize.Wsh.buildFiles(Uize.copyInto({logFileName:_j.replace(_i,'-js-files.log'),targetFolderPathCreator:_o,targetFilenameCreator:function(_p){return _i.test(_p)?_p:null;},fileBuilder:function(_p,_q){var _r=_p.replace(_i,''),_s={},_t=_k[_p.slice(0,_p.indexOf('.'))],_u=_t==undefined;if(!_u)
_s.KEEPHEADCOMMENT='FALSE';if(_m==_n)Uize.require(_r,function(_v){var _w=Uize.Util.Oop.getInheritanceChain(_v).length;_s.MAPPINGS='='+(_w?_l.charAt(_w-1):'')+','+_r.replace(/\./g,'_');});var _x=Uize.Build.Scruncher.scrunch(_q,_s);return{outputText:(_u?'':Uize.substituteInto(_t,{buildDate:_h,moduleName:_r},'{KEY}'))+_x.scrunchedCode,logDetails:Uize.String.Lines.indent(_x.report,2)+'\n'};}},_g));var _y=/\/\*\s*Library\s*Contents/i,_z=/^[a-zA-Z_$]/,_A=_o(_n),_B='/*______________\n'+'|       ______  |   B U I L T     O N     U I Z E     F R A M E W O R K\n'+'|     /      /  |   ---------------------------------------------------\n'+'|    /    O /   |   This JavaScript application is developed using the object\n'+'|   /    / /    |   oriented UIZE JavaScript framework as its foundation.\n'+'|  /    / /  /| |\n'+'| /____/ /__/_| |    ONLINE : http://www.uize.com\n'+'|          /___ |   LICENSE : Available under MIT License or GNU General Public License\n'+
'|_______________|             http://www.uize.com/license.html\n'+'*/\n\n';Uize.Wsh.buildFiles(Uize.copyInto({targetFolderPathCreator:_o,targetFilenameCreator:function(_p){return/\.library.js$/.test(_p)?_p:null;},fileBuilder:function(_p,_q){function _C(_D){var _E=_D.indexOf('/*');return(_E> -1?(_D.slice(0,_E)+_D.slice(_D.indexOf('*/',_E+2)+2)):_D);}var _F=[],_G;for(var _H= -1,_I=_q.search(_y),_J=_q.indexOf('*/',_I),_K=Uize.String.Lines.split(_I> -1?_q.slice(_I,_J).replace(_y,''):_q),_L=_K.length;++_H<_L;){var _r=Uize.String.trim(_K[_H]);if(_r&&_z.test(_r)){if(!_G)_G=Uize.String.startsWith(_r,'Uize');_F.push('\n'+_C(Uize.Wsh.readFile(_A+'\\'+_r+(_i.test(_r)?'':'.js'))));}}return{outputText:(_G?_B:'')+_q.slice(0,_I)+_F.join('\n')+_q.slice(_J+2)};}},_g,{alwaysBuild:true,logFileName:_j.replace(_i,'-libraries.log')}));};return _a;}});