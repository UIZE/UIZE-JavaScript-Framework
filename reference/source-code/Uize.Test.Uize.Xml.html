<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>Uize.Test.Uize.Xml | JavaScript Source Code | UIZE JavaScript Framework</title>
	<meta name="keywords" content="UIZE JavaScript Framework module source code"/>
	<meta name="description" content="This is the JavaScript source code for the Uize.Test.Uize.Xml module of the UIZE JavaScript Framework"/>
	<link rel="alternate" type="application/rss+xml" title="UIZE JavaScript Framework - Latest News" href="http://www.uize.com/latest-news.rss"/>
	<link rel="stylesheet" href="../../css/page.css"/>
	<link rel="stylesheet" href="../../css/page.source.css"/>
</head>

<body>

<script type="text/javascript" src="../../js/Uize.js"></script>

<h1 class="document-title">
	<a id="page-homeLink" href="../../index.html" title="UIZE JavaScript Framework home"></a>
	SOURCE CODE: Uize.Test.Uize.Xml
	<div class="pageActions">
		<a href="../Uize.Test.Uize.Xml.html" class="buttonLink">VIEW REFERENCE</a>
	</div>
</h1>

<pre>
/*______________
|       ______  |   U I Z E    J A V A S C R I P T    F R A M E W O R K
|     /      /  |   ---------------------------------------------------
|    /    O /   |    MODULE : Uize.Test.Uize.Xml Class
|   /    / /    |
|  /    / /  /| |    ONLINE : http://www.uize.com
| /____/ /__/_| | COPYRIGHT : (c)2010-2012 UIZE
|          /___ |   LICENSE : Available under MIT License or GNU General Public License
|_______________|             http://www.uize.com/license.html
*/

/*ScruncherSettings Mappings="=" LineCompacting="TRUE"*/

/* Module Meta Data
  type: Test
  importance: 2
  codeCompleteness: 100
  testCompleteness: 100
  docCompleteness: 100
*/

/*?
  Introduction
    The =Uize.Test.Uize.Xml= module defines a suite of unit tests for the =Uize.Xml= module.

    *DEVELOPERS:* `Chris van Rensburg`
*/

Uize.module ({
  name:'Uize.Test.Uize.Xml',
  required:'Uize.Class',
  builder:function () {
    /*** create dummy class with value interface ***/
      var _ClassWithValueInterface = Uize.Class.subclass ();
      _ClassWithValueInterface.registerProperties ({
        _value:'value'
      });

    return Uize.Test.declare ({
      title:'Test for Uize.Xml Module',
      test:[
        Uize.Test.requiredModulesTest ('Uize.Xml'),
        Uize.Test.staticMethodsTest ([
          ['Uize.Xml.toAttributeValue',[
            ['Test that calling with empty string produces empty string',
              '',
              ''
            ],
            ['Test that a string that doesn\'t contain any characters that need encoding is returned as is',
              'SOLAR POWER',
              'SOLAR POWER'
            ],
            ['Test that a string containing "&amp;" (ampersand) characters is encoded correctly',
              'SOLAR &amp; WIND &amp; BIOFUEL &amp; GEOTHERMAL',
              'SOLAR &amp;amp; WIND &amp;amp; BIOFUEL &amp;amp; GEOTHERMAL'
            ],
            ['Test that a string containing "\\n" (linefeed) characters is encoded correctly',
              'SOLAR\nWIND\nBIOFUEL\nGEOTHERMAL',
              'SOLAR&amp;#10;WIND&amp;#10;BIOFUEL&amp;#10;GEOTHERMAL'
            ],
            ['Test that a string containing "\\r" (carriage return) characters is encoded correctly',
              'SOLAR\rWIND\rBIOFUEL\rGEOTHERMAL',
              'SOLAR&amp;#13;WIND&amp;#13;BIOFUEL&amp;#13;GEOTHERMAL'
            ],
            ['Test that a string containing double quotes is encoded correctly',
              '"SOLAR" "WIND" "BIOFUEL" "GEOTHERMAL"',
              '&amp;quot;SOLAR&amp;quot; &amp;quot;WIND&amp;quot; &amp;quot;BIOFUEL&amp;quot; &amp;quot;GEOTHERMAL&amp;quot;'
            ],
            ['Test that a string containing single quotes is encoded correctly',
              '\'SOLAR\' \'WIND\' \'BIOFUEL\' \'GEOTHERMAL\'',
              '&amp;apos;SOLAR&amp;apos; &amp;apos;WIND&amp;apos; &amp;apos;BIOFUEL&amp;apos; &amp;apos;GEOTHERMAL&amp;apos;'
            ],
            ['Test that a string containing "&lt;" (less than sign) characters is encoded correctly',
              '1 &lt; 2 &lt; 3 &lt; 4',
              '1 &amp;lt; 2 &amp;lt; 3 &amp;lt; 4'
            ],
            ['Test that a string containing "&gt;" (greater than sign) characters is encoded correctly',
              '4 &gt; 3 &gt; 2 &gt; 1',
              '4 &amp;gt; 3 &amp;gt; 2 &amp;gt; 1'
            ],
            ['Test that a string containing multiple characters that need to be encoded is encoded correctly',
              'SOLAR &amp; WIND\n"BIOFUEL"\r&lt;GEOTHERMAL&gt;',
              'SOLAR &amp;amp; WIND&amp;#10;&amp;quot;BIOFUEL&amp;quot;&amp;#13;&amp;lt;GEOTHERMAL&amp;gt;'
            ],
            ['Test that the value undefined is coerced to a string before being encoded',
              undefined,
              'undefined'
            ],
            ['Test that the value null is coerced to a string before being encoded',
              null,
              'null'
            ],
            ['Test that a number type value is coerced to a string before being encoded',
              42,
              '42'
            ],
            ['Test that the number type value NaN is coerced to a string before being encoded',
              NaN,
              'NaN'
            ],
            ['Test that the number type value Infinity is coerced to a string before being encoded',
              Infinity,
              'Infinity'
            ],
            ['Test that the boolean type value false is coerced to a string before being encoded',
              false,
              'false'
            ],
            ['Test that a Boolean object instance is coerced to a string before being encoded',
              [new Boolean (true)],
              'true'
            ],
            ['Test that a Number object instance is coerced to a string before being encoded',
              [new Number (42)],
              '42'
            ],
            ['Test that a String object instance is coerced to a string before being encoded',
              [new String ('SOLAR POWER')],
              'SOLAR POWER'
            ],
            ['Test that a Uize class instance is coerced to a string before being encoded',
              [new _ClassWithValueInterface ({value:'SOLAR POWER'})],
              'SOLAR POWER'
            ]
          ]],
          ['Uize.Xml.fromAttributeValue',[
            ['Test that calling with empty string produces empty string',
              '',
              ''
            ],
            ['Test that a string that doesn\'t contain any entities is returned as is',
              'SOLAR POWER',
              'SOLAR POWER'
            ],
            ['Test that entities are decoded correctly',
              '&amp;quot; &amp;amp; &amp;apos; &amp;lt; &amp;gt; &amp;#10; &amp;#13;',
              '" &amp; \' &lt; &gt; \n \r'
            ],
            ['Test that some arbitrary character code entity is decoded correctly',
              '&amp;#1234;',
              String.fromCharCode (1234)
            ],
            ['Test that the value undefined is coerced to a string before being decoded',
              undefined,
              'undefined'
            ],
            ['Test that the value null is coerced to a string before being decoded',
              null,
              'null'
            ],
            ['Test that a number type value is coerced to a string before being decoded',
              42,
              '42'
            ],
            ['Test that the number type value NaN is coerced to a string before being decoded',
              NaN,
              'NaN'
            ],
            ['Test that the number type value Infinity is coerced to a string before being decoded',
              Infinity,
              'Infinity'
            ],
            ['Test that the boolean type value false is coerced to a string before being decoded',
              false,
              'false'
            ],
            ['Test that a Boolean object instance is coerced to a string before being decoded',
              [new Boolean (true)],
              'true'
            ],
            ['Test that a Number object instance is coerced to a string before being decoded',
              [new Number (42)],
              '42'
            ],
            ['Test that a String object instance is coerced to a string before being decoded',
              [new String ('SOLAR POWER')],
              'SOLAR POWER'
            ],
            ['Test that a Uize class instance is coerced to a string before being decoded',
              [new _ClassWithValueInterface ({value:'SOLAR POWER'})],
              'SOLAR POWER'
            ]
          ]],
          ['Uize.Xml.toAttributes',[
            ['Test that calling with no parameters produces an empty string',
              [],
              ''
            ],
            ['Test that calling with an empty object produces an empty string',
              {},
              ''
            ],
            ['Test that an object with a single attribute whose value contains no characters that need encoding is encoded correctly',
              {attrib1:'attrib1Value'},
              'attrib1="attrib1Value"'
            ],
            ['Test that an object with multiple attributes is encoded correctly',
              {attrib1:'attrib1Value',attrib2:'attrib2Value',attrib3:'attrib3Value'},
              'attrib1="attrib1Value" attrib2="attrib2Value" attrib3="attrib3Value"'
            ],
            ['Test that single quotes are supported for quoting attribute valus',
              [{attrib1:'attrib1Value',attrib2:'attrib2Value',attrib3:'attrib3Value'},{quoteChar:'\''}],
              'attrib1=\'attrib1Value\' attrib2=\'attrib2Value\' attrib3=\'attrib3Value\''
            ],
            ['Test that single quotes are supported for quoting attribute valus',
              {'':'attribValue',foo:'bar'},
              'foo="bar"'
            ],
            ['Test that attributes can have empty string values',
              {attrib1:'',attrib2:''},
              'attrib1="" attrib2=""'
            ],
            ['Test that whitespace inside attribute values is respected',
              {a1:'  a1Value',a2:'a2Value  ',a3:'  a3Value  ',a4:'a4 Value',a5:'\t a5 \n Value \r'},
              'a1="  a1Value" a2="a2Value  " a3="  a3Value  " a4="a4 Value" a5="\t a5 &amp;#10; Value &amp;#13;"'
            ],
            ['Test that attribute values can be only whitespace',
              {a1:'  ',a2:'\t\t',a3:'\n\n',a4:'\r\r'},
              'a1="  " a2="\t\t" a3="&amp;#10;&amp;#10;" a4="&amp;#13;&amp;#13;"'
            ],
            ['Test that, by default, attribute names and values are case-sensitive, and that case is respected',
              {attribute:'attribute',Attribute:'Attribute',ATTRIBUTE:'ATTRIBUTE'},
              'attribute="attribute" Attribute="Attribute" ATTRIBUTE="ATTRIBUTE"'
            ],
            ['Test that lowercasing of attribute names is supported correctly and doesn\'t affect case of values',
              [{attrib1:'attrib1Value',Attrib2:'Attrib2Value',ATTRIB3:'ATTRIB3VALUE'},{nameCase:'lower'}],
              'attrib1="attrib1Value" attrib2="Attrib2Value" attrib3="ATTRIB3VALUE"'
            ],
            ['Test that uppercasing of attribute names is supported correctly and doesn\'t affect case of values',
              [{attrib1:'attrib1Value',Attrib2:'Attrib2Value',ATTRIB3:'ATTRIB3VALUE'},{nameCase:'upper'}],
              'ATTRIB1="attrib1Value" ATTRIB2="Attrib2Value" ATTRIB3="ATTRIB3VALUE"'
            ],
            ['Test that unique attributes can become duplicates as a result of name case changing, in which case the value of the last one wins',
              [{attribute:'BIOFUEL',Attribute:'WIND',ATTRIBUTE:'SOLAR'},{nameCase:'lower'}],
              'attribute="SOLAR"'
            ],
            ['Test that characters in attribute values that need to be encoded as entities are encoded correctly',
              {quot:'"',amp:'&amp;',apos:'\'',lt:'&lt;',gt:'&gt;',lf:'\n',cr:'\r'},
              'quot="&amp;quot;" amp="&amp;amp;" apos="&amp;apos;" lt="&amp;lt;" gt="&amp;gt;" lf="&amp;#10;" cr="&amp;#13;"'
            ],
            ['Test that non-string type attribute values are coerced to string before being encoded',
              {
                number:42,
                infinity:Infinity,
                nan:NaN,
                bool:true,
                stringObj:new String ('hello'),
                numberObj:new Number (42),
                boolObj:new Boolean (false),
                uizeInstance:new _ClassWithValueInterface ({value:'hello'}),
                undefinedValue:undefined,
                nullValue:null,
                array:[1,2,3,4]
              },
              [
                'number="42"',
                'infinity="Infinity"',
                'nan="NaN"',
                'bool="true"',
                'stringObj="hello"',
                'numberObj="42"',
                'boolObj="false"',
                'uizeInstance="hello"',
                'undefinedValue="undefined"',
                'nullValue="null"',
                'array="1,2,3,4"'
              ].join (' ')
            ]
          ]],
          ['Uize.Xml.fromAttributes',[
            ['Test that calling with no parameters produces an empty object',
              [],
              {}
            ],
            ['Test that calling with an empty string produces an empty object',
              '',
              {}
            ],
            ['Test that a string with a single attribute whose value contains no entities is decoded correctly',
              'attrib1="attrib1Value"',
              {attrib1:'attrib1Value'}
            ],
            ['Test that a string with multiple attributes is decoded correctly',
              'attrib1="attrib1Value" attrib2="attrib2Value" attrib3="attrib3Value"',
              {attrib1:'attrib1Value',attrib2:'attrib2Value',attrib3:'attrib3Value'}
            ],
            ['Test that superfluous whitespace around a set of attributes is ignored',
              ' \t\n\r attrib1="attrib1Value" attrib2="attrib2Value" attrib3="attrib3Value" \t\n\r ',
              {attrib1:'attrib1Value',attrib2:'attrib2Value',attrib3:'attrib3Value'}
            ],
            ['Test that various different types of whitespace separating multiple attributes is supported',
              'a1="a1Value"   a2="a2Value"\t\ta3="a3Value"\na4="a4Value"\ra5="a5Value"',
              {a1:'a1Value',a2:'a2Value',a3:'a3Value',a4:'a4Value',a5:'a5Value'}
            ],
            ['Test that whitespace around the "=" (equals sign) name/value separator is supported',
              'a1  =  "a1Value" a2\t\t=\t\t"a2Value" a3\n\n=\n\n"a3Value" a4\r\r=\r\r"a4Value"',
              {a1:'a1Value',a2:'a2Value',a3:'a3Value',a4:'a4Value'}
            ],
            ['Test that attributes without values are supported and that their values are an empty string',
              'attrib1 attrib2 attrib3',
              {attrib1:'',attrib2:'',attrib3:''}
            ],
            ['Test that single quotes are supported for quoting attribute valus',
              'attrib1=\'attrib1Value\' attrib2=\'attrib2Value\' attrib3=\'attrib3Value\'',
              {attrib1:'attrib1Value',attrib2:'attrib2Value',attrib3:'attrib3Value'}
            ],
            ['Test that attributes can have empty string values inside quotes',
              'attrib1="" attrib2=\'\'',
              {attrib1:'',attrib2:''}
            ],
            ['Test that whitespace inside attribute values is respected',
              'a1="  a1Value" a2="a2Value  " a3="  a3Value  " a4="a4 Value" a5="\t a5 \n Value \r"',
              {a1:'  a1Value',a2:'a2Value  ',a3:'  a3Value  ',a4:'a4 Value',a5:'\t a5 \n Value \r'}
            ],
            ['Test that attribute values can be only whitespace',
              'a1="  " a2="\t\t" a3="\n\n" a4="\r\r"',
              {a1:'  ',a2:'\t\t',a3:'\n\n',a4:'\r\r'}
            ],
            ['Test that, by default, attribute names and values are case-sensitive, and that case is respected',
              'attribute="attribute" Attribute="Attribute" ATTRIBUTE="ATTRIBUTE"',
              {attribute:'attribute',Attribute:'Attribute',ATTRIBUTE:'ATTRIBUTE'}
            ],
            ['Test that lowercasing of attribute names is supported correctly and doesn\'t affect case of values',
              ['attrib1="attrib1Value" Attrib2="Attrib2Value" ATTRIB3="ATTRIB3VALUE"',{nameCase:'lower'}],
              {attrib1:'attrib1Value',attrib2:'Attrib2Value',attrib3:'ATTRIB3VALUE'}
            ],
            ['Test that uppercasing of attribute names is supported correctly and doesn\'t affect case of values',
              ['attrib1="attrib1Value" Attrib2="Attrib2Value" ATTRIB3="ATTRIB3VALUE"',{nameCase:'upper'}],
              {ATTRIB1:'attrib1Value',ATTRIB2:'Attrib2Value',ATTRIB3:'ATTRIB3VALUE'}
            ],
            ['Test that when attributes are repeated, later values win',
              'attribute="BIOFUEL" attribute="WIND" attribute="SOLAR"',
              {attribute:'SOLAR'}
            ],
            ['Test that unique attributes can become duplicates as a result of name case changing',
              ['attribute="BIOFUEL" Attribute="WIND" ATTRIBUTE="SOLAR"',{nameCase:'lower'}],
              {attribute:'SOLAR'}
            ],
            ['Test that entities in attribute values are decoded correctly',
              'quot="&amp;quot;" amp="&amp;amp;" apos="&amp;apos;" lt="&amp;lt;" gt="&amp;gt;" lf="&amp;#10;" cr="&amp;#13;"',
              {quot:'"',amp:'&amp;',apos:'\'',lt:'&lt;',gt:'&gt;',lf:'\n',cr:'\r'}
            ]
          ]]
        ])
      ]
    });
  }
});


</pre>

<script type="text/javascript">

Uize.module ({
	required:[
		'UizeDotCom.Page.library',
		'UizeDotCom.Page'
	],
	builder:function () {(window.page = UizeDotCom.Page ()).wireUi ()}
});

</script>

</body></html>
